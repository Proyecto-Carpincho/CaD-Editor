# Docs V-1.1

[Changlog](https://github.com/Proyecto-Carpincho/CaD-Editor/blob/main/Docs/V-1.1/V-1.1%20Changelog.md)

[How Install](https://github.com/Proyecto-Carpincho/CaD-Editor/blob/main/Docs/V-1.1/V-1.1%20Install.md)

---

- [Cinematic Player](#cinematic-player)
- [Editor](#editor)
- [Nodes](#nodes)

---

## Cinematic Player

### Creation
It is created as a **normal node** and assigned the corresponding resource.  
Once done, the editor will automatically open.

<img src="https://github.com/Proyecto-Carpincho/CaD-Editor/blob/main/Docs/V-1.1/IMG/Docs%20CinematicPlayer%201.png" width="700"/>

With a **right-click**, a window will appear to select the nodes, with an appearance like this:

<img src="https://github.com/Proyecto-Carpincho/CaD-Editor/blob/main/Docs/V-1.1/IMG/Docs%20CinematicPlayer2.png" width="700"/>


At the bottom, you will find a button called **"View Console"**, which opens a mini console that displays errors generated during use.

<img src="https://github.com/Proyecto-Carpincho/CaD-Editor/blob/main/Docs/V-1.1/IMG/Docs%20Editor%203.png" width="500"/>

In the **Inspector**, you will see 3 tabs (if `ImportData` is available; otherwise, only 2 will be visible).

---

### Paths

#### `VAR NodePaths`
A list of nodes that can be used by other nodes for various options.  
Examples: `MethodNode`, `DialogicNode`, `WaitSignal`.

#### `VAR AnimationPlayers`
A list of `AnimationPlayer` nodes that can be used to animate through `AnimationNode`.

> [!WARNING]  
> Be careful when **modifying these lists during runtime**, as the nodes may not be found correctly or may not be found at all.

---

### Autoload Dialogue

#### `VAR DialogueFile`
The file where the dialogues are searched.  

> [!NOTE]  
> This plugin **does not require Godot localization**.  
> It always takes the **first line as the key** and the **second line as the text to display**, regardless of the default language.

#### `VAR AutoloadDialog`
The autoload that can be used for dialogues.  

> [!NOTE]  
> This **does not mean the plugin strictly requires** an autoload.  
> Nodes from the `NodePaths` list can be chosen instead.  
> Even between one node and another, an autoload can be selected.

#### `VAR DialogMethod`
The method that will be called for dialogues that use an autoload.  

> [!WARNING]  
> When changing the selected autoload, **reload the inspector by changing the selected node**.  
> This behavior is designed to improve performance.

#### `VAR SignalName`
The signal that will be emitted in case you are using an autoload along with a signal.

---

### All Data

This section contains the **variables you created** in the **CaD editor** using `ImportData`.

> [!NOTE]  
> If you want to **modify or access these variables via code**, **do not** use the following:  
> ```gdscript
> get_node("CinematicPlayer").YourCreatedVariableName
> ```
>  
> Instead, use this approach:  
> ```gdscript
> get_node("CinematicPlayer").dicImportVar[YourCreatedVariableName]
> ```

---

## Editor

The **Cinematic Editor** works as follows:

- Every cinematic always starts from the **`StartNode`**.  
  <img src="https://github.com/Proyecto-Carpincho/CaD-Editor/blob/main/Docs/V-1.1/IMG/Docs%20Editor%201.png" width="100"/>

- For a node to be executed, it **must be connected** to another node.  
  Example:  
  <img src="https://github.com/Proyecto-Carpincho/CaD-Editor/blob/main/Docs/V-1.1/IMG/Docs%20Editor%202.png" width="600"/>

- Nodes are executed **step by step**, following their connections in sequence.

- When a node connected to an **`EndNode`** is reached (regardless of whether other nodes are still running),  
  the editor will emit the signal **`CinematicEND`**.



---

## Nodes
## Nodes

### Animation Node
Executes an animation from an `AnimationPlayer`.  
- Allows selecting the `AnimationPlayer` from a list of registered paths.  
- Supports choosing a specific animation by name.  
- Options:  
  - **Wait PreAnimation**: Waits until the current animation finishes before playing the next one.  
  - **Wait NextAnimation**: Waits until the selected animation ends before moving on.  

If no `AnimationPlayer` is found, an error is logged.

---

### Wait Node
Pauses the cinematic for a given amount of time.  
- Configurable with a `SpinBox` to set the number of seconds.  
- Internally connects to the editor’s `Timeout` signal.  
- Once the timer finishes, it emits the `NextNode` signal to continue execution.  

---

### Chooser Node
Allows branching based on multiple options.  
- Manages a dynamic list of **choices** (`ChoiceNode`s).  
- Choices are displayed in a list and can be added or removed at runtime.  
- Each choice is linked to the parent node through its **Creator ID**.  
- Uses **bitmask flags** to select which choices are valid in a given execution.  
- On execution, it outputs an array with the selected choice IDs and then continues to the next node.  

---

### Import Data Node
Used to define custom variables in the cinematic system.  
- Supports all Godot data types (`int`, `float`, `string`, `Vector2`, etc.).  
- Each variable has:  
  - A **name**  
  - A **type** (selectable from a list or via numeric type ID)  
- Automatically registers the variable in the `CinematicPlayer` under:  
  - `dicImportTypeVar` → Type of the variable.  
  - `dicImportVar` → Value (initialized as `null`).  

This allows storing and retrieving values during cinematic execution.

---

### Method Node
Calls a method on a target node.  
- Selects a node from `NodePaths`.  
- Displays all available methods of that node for selection.  
- Supports adding parameters dynamically.  
- Calls the chosen method with the given parameters, then emits `NextNode`.  

---

### Wait Signal Node
Waits until a specific signal is emitted from a node.  
- Selects a node from `NodePaths`.  
- Enter the **signal name** to listen for.  
- Execution pauses until the signal is emitted.  
- If the signal doesn’t exist on the node, an error is logged.  

---

### Cinematic Node (Base Class)
Abstract base for all cinematic nodes.  
- Provides common functionality:  
  - Connection with the cinematic editor.  
  - Emitting the `NextNode` signal.  
  - Logging errors into the editor console.  
- Defines `StartAction()`, meant to be overridden by derived nodes.  

---
